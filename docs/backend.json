{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile within the laSalapp application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "googleId": {
          "type": "string",
          "description": "The user's Google ID."
        },
        "name": {
          "type": "string",
          "description": "The user's name."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "role": {
          "type": "string",
          "description": "The user's role within the application (e.g., administrator, team member).  Consider creating a separate 'Role' entity for more complex permission management."
        }
      },
      "required": [
        "id",
        "googleId",
        "name",
        "email",
        "role"
      ]
    },
    "TeamMember": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TeamMember",
      "type": "object",
      "description": "Represents a team member within the organization.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the team member."
        },
        "userProfileId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:1 TeamMember)"
        },
        "role": {
          "type": "string",
          "description": "The team member's role."
        },
        "permissions": {
          "type": "array",
          "description": "An array of permissions granted to the team member.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "userProfileId",
        "role",
        "permissions"
      ]
    },
    "Programming": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Programming",
      "type": "object",
      "description": "Represents a programming event or show.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the programming event."
        },
        "company": {
          "type": "string",
          "description": "The name of the company performing."
        },
        "showName": {
          "type": "string",
          "description": "The name of the show."
        },
        "contactPerson": {
          "type": "string",
          "description": "Contact person for the company."
        },
        "interactions": {
          "type": "string",
          "description": "Summary of interactions and notes about the show/company."
        }
      },
      "required": [
        "id",
        "company",
        "showName"
      ]
    },
    "Event": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Event",
      "type": "object",
      "description": "Represents a scheduled event, such as a performance or marketing activity.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the event."
        },
        "eventType": {
          "type": "string",
          "description": "The type of event (e.g., performance, marketing, social media)."
        },
        "startTime": {
          "type": "string",
          "description": "The start time of the event.",
          "format": "date-time"
        },
        "endTime": {
          "type": "string",
          "description": "The end time of the event.",
          "format": "date-time"
        },
        "description": {
          "type": "string",
          "description": "A description of the event."
        }
      },
      "required": [
        "id",
        "eventType",
        "startTime",
        "endTime",
        "description"
      ]
    },
    "Expense": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Expense",
      "type": "object",
      "description": "Represents an expense incurred by the organization.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the expense."
        },
        "teamMemberId": {
          "type": "string",
          "description": "Reference to TeamMember. (Relationship: TeamMember 1:N Expense) The team member who incurred the expense."
        },
        "date": {
          "type": "string",
          "description": "The date the expense was incurred.",
          "format": "date-time"
        },
        "amount": {
          "type": "number",
          "description": "The amount of the expense."
        },
        "category": {
          "type": "string",
          "description": "The category of the expense (e.g., structural, materials, basic)."
        },
        "description": {
          "type": "string",
          "description": "A description of the expense."
        }
      },
      "required": [
        "id",
        "teamMemberId",
        "date",
        "amount",
        "category",
        "description"
      ]
    },
    "MeetingMinutes": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MeetingMinutes",
      "type": "object",
      "description": "Represents the minutes of a meeting.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the meeting minutes."
        },
        "date": {
          "type": "string",
          "description": "The date of the meeting.",
          "format": "date-time"
        },
        "attendees": {
          "type": "array",
          "description": "List of attendees at the meeting.",
          "items": {
            "type": "string"
          }
        },
        "minutes": {
          "type": "string",
          "description": "The minutes of the meeting."
        }
      },
      "required": [
        "id",
        "date",
        "minutes"
      ]
    },
    "Responsibility": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Responsibility",
      "type": "object",
      "description": "Represents a task or responsibility assigned to a team member.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the responsibility."
        },
        "teamMemberId": {
          "type": "string",
          "description": "Reference to TeamMember. (Relationship: TeamMember 1:N Responsibility) The team member assigned to the responsibility."
        },
        "description": {
          "type": "string",
          "description": "A description of the responsibility."
        },
        "deadline": {
          "type": "string",
          "description": "The deadline for completing the responsibility.",
          "format": "date-time"
        },
        "checklist": {
          "type": "array",
          "description": "A checklist of tasks to complete for the responsibility.",
          "items": {
            "type": "string"
          }
        },
        "isCompleted": {
          "type": "boolean",
          "description": "Indicates whether the responsibility has been completed."
        }
      },
      "required": [
        "id",
        "teamMemberId",
        "description",
        "deadline"
      ]
    },
    "TodoItem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TodoItem",
      "type": "object",
      "description": "Represents an item in the general to-do list.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the to-do item."
        },
        "description": {
          "type": "string",
          "description": "A description of the to-do item."
        },
        "deadline": {
          "type": "string",
          "description": "The deadline for completing the to-do item.",
          "format": "date-time"
        },
        "isCompleted": {
          "type": "boolean",
          "description": "Indicates whether the to-do item has been completed."
        }
      },
      "required": [
        "id",
        "description",
        "deadline"
      ]
    },
    "Production": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Production",
      "type": "object",
      "description": "Represents an in-house production.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the production."
        },
        "name": {
          "type": "string",
          "description": "The name of the production."
        },
        "description": {
          "type": "string",
          "description": "A description of the production."
        },
        "googleDriveLink": {
          "type": "string",
          "description": "Link to assets stored on Google Drive.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "Idea": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Idea",
      "type": "object",
      "description": "Represents an idea generated during a brainstorming session.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the idea."
        },
        "description": {
          "type": "string",
          "description": "A description of the idea."
        },
        "brainstormSession": {
          "type": "string",
          "description": "The brainstorm session this idea came from.  Consider creating a separate BrainstormSession entity."
        }
      },
      "required": [
        "id",
        "description"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/user_profiles/{userProfileId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information. Accessible to the user and administrators.",
          "params": [
            {
              "name": "userProfileId",
              "description": "The unique ID of the user profile."
            }
          ]
        }
      },
      {
        "path": "/team_members/{teamMemberId}",
        "definition": {
          "entityName": "TeamMember",
          "schema": {
            "$ref": "#/backend/entities/TeamMember"
          },
          "description": "Stores team member information. Accessible to the team member and administrators.",
          "params": [
            {
              "name": "teamMemberId",
              "description": "The unique ID of the team member."
            }
          ]
        }
      },
      {
        "path": "/programming/{programmingId}",
        "definition": {
          "entityName": "Programming",
          "schema": {
            "$ref": "#/backend/entities/Programming"
          },
          "description": "Stores programming event information. Accessible to authorized personnel.",
          "params": [
            {
              "name": "programmingId",
              "description": "The unique ID of the programming event."
            }
          ]
        }
      },
      {
        "path": "/events/{eventId}",
        "definition": {
          "entityName": "Event",
          "schema": {
            "$ref": "#/backend/entities/Event"
          },
          "description": "Stores event schedule information. Accessible to authorized personnel.",
          "params": [
            {
              "name": "eventId",
              "description": "The unique ID of the event."
            }
          ]
        }
      },
      {
        "path": "/team_members/{teamMemberId}/expenses/{expenseId}",
        "definition": {
          "entityName": "Expense",
          "schema": {
            "$ref": "#/backend/entities/Expense"
          },
          "description": "Stores expense information for each team member. Accessible to the team member and administrators.",
          "params": [
            {
              "name": "teamMemberId",
              "description": "The unique ID of the team member."
            },
            {
              "name": "expenseId",
              "description": "The unique ID of the expense."
            }
          ]
        }
      },
      {
        "path": "/meeting_minutes/{meetingMinutesId}",
        "definition": {
          "entityName": "MeetingMinutes",
          "schema": {
            "$ref": "#/backend/entities/MeetingMinutes"
          },
          "description": "Stores meeting minutes. Accessible to authorized personnel.",
          "params": [
            {
              "name": "meetingMinutesId",
              "description": "The unique ID of the meeting minutes."
            }
          ]
        }
      },
      {
        "path": "/team_members/{teamMemberId}/responsibilities/{responsibilityId}",
        "definition": {
          "entityName": "Responsibility",
          "schema": {
            "$ref": "#/backend/entities/Responsibility"
          },
          "description": "Stores responsibility assignments for team members. Accessible to the team member and administrators.",
          "params": [
            {
              "name": "teamMemberId",
              "description": "The unique ID of the team member."
            },
            {
              "name": "responsibilityId",
              "description": "The unique ID of the responsibility."
            }
          ]
        }
      },
      {
        "path": "/todo_items/{todoItemId}",
        "definition": {
          "entityName": "TodoItem",
          "schema": {
            "$ref": "#/backend/entities/TodoItem"
          },
          "description": "Stores general to-do list items. Accessible to authorized personnel.",
          "params": [
            {
              "name": "todoItemId",
              "description": "The unique ID of the to-do item."
            }
          ]
        }
      },
      {
        "path": "/productions/{productionId}",
        "definition": {
          "entityName": "Production",
          "schema": {
            "$ref": "#/backend/entities/Production"
          },
          "description": "Stores in-house production information. Includes denormalized 'members' map for authorization independence.",
          "params": [
            {
              "name": "productionId",
              "description": "The unique ID of the production."
            }
          ]
        }
      },
      {
        "path": "/ideas/{ideaId}",
        "definition": {
          "entityName": "Idea",
          "schema": {
            "$ref": "#/backend/entities/Idea"
          },
          "description": "Stores brainstormed ideas. Accessible to authorized personnel.",
          "params": [
            {
              "name": "ideaId",
              "description": "The unique ID of the idea."
            }
          ]
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "entityName": "adminRole",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Indicates administrator privileges. Existence of document grants admin access.",
          "params": [
            {
              "name": "userId",
              "description": "The unique ID of the user."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure is designed to support the laSalapp application, focusing on secure access, team management, scheduling, and various other features. The structure adheres to the principles of Authorization Independence, Clarity of Intent, DBAC (Database-Based Access Control), and QAPs (Rules are Not Filters).\n\n**Authorization Independence:**\nAuthorization is primarily managed using path-based ownership and membership maps, avoiding hierarchical `get()` calls in security rules. For example, expenses are stored under a team member's ID (`/team_members/{teamMemberId}/expenses/{expenseId}`), allowing direct authorization based on the `teamMemberId`.\n\n**Structural Segregation:**\nDifferent types of data with varying access requirements are stored in separate collections to ensure homogeneous security postures. User profiles are stored in `/user_profiles/{userProfileId}`, while team member data resides in `/team_members/{teamMemberId}`. This segregation simplifies security rule definitions.\n\n**Access Modeling:**\n*   **Private Data:** User-related data like expenses and responsibilities are placed under `/team_members/{teamMemberId}`, ensuring only the team member and admins can access them.\n*   **Collaborative Data:**  The in-house production hub uses a membership map for collaborative access. The `members` field within each production document (`/productions/{productionId}`) stores a map of user IDs to roles, enabling fine-grained access control without requiring `get()` calls in security rules. For example, `members: {uid1: \"owner\", uid2: \"collaborator\"}`.\n*   **Global Roles (DBAC):** Admin roles are managed via the `/roles_admin/{uid}` collection. The existence of a document in this collection grants admin privileges.\n\n**QAPs Support:**\nThe structure supports secure `list` operations by using structural segregation and path-based ownership. Listing events is restricted using collection-level rules on the `/events` collection, ensuring that only authorized users can access event data.\n\n**Invariants:**\nThe design supports data integrity by enforcing ownership and relationships through the structure. For instance, expenses are linked to team members via the `teamMemberId` field, ensuring expenses are always associated with a valid team member."
  }
}